<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.37" />
  <meta name="author" content="Jayanth Reddy Regatti">

  
  
  
  
    
      
    
  
  <meta name="description" content="Life can only be understood going backwards, but it must be lived going forwards - Kierkegaard.
Dynamic Programming is a mathematical technique that is used in several fields of research including economics, finance, engineering. It deals with making decisions over different stages of the problem in order to minimize (or maximize) a corresponding cost function (or reward). The outcome of a decision at a given stage can be fully predicted (deterministic) or can only be partially predicted (with randomness involved).">

  
  <link rel="alternate" hreflang="en-us" href="https://jayanthrr.github.io/post/rollout/">

  


  

  
  
  <meta name="theme-color" content="#0095eb">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="https://jayanthrr.github.io/index.xml" type="application/rss+xml" title="Jayanth">
  <link rel="feed" href="https://jayanthrr.github.io/index.xml" type="application/rss+xml" title="Jayanth">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://jayanthrr.github.io/post/rollout/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Jayanth">
  <meta property="og:url" content="https://jayanthrr.github.io/post/rollout/">
  <meta property="og:title" content="Rollout | Jayanth">
  <meta property="og:description" content="Life can only be understood going backwards, but it must be lived going forwards - Kierkegaard.
Dynamic Programming is a mathematical technique that is used in several fields of research including economics, finance, engineering. It deals with making decisions over different stages of the problem in order to minimize (or maximize) a corresponding cost function (or reward). The outcome of a decision at a given stage can be fully predicted (deterministic) or can only be partially predicted (with randomness involved).">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-02-27T14:29:56-05:00">
  
  <meta property="article:modified_time" content="2018-02-27T14:29:56-05:00">
  

  

  <title>Rollout | Jayanth</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Jayanth</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Rollout</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-02-27 14:29:56 -0500 EST" itemprop="datePublished dateModified">
      Feb 27, 2018
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jayanth Reddy Regatti">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    4 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="https://jayanthrr.github.io/post/rollout/#disqus_thread"></a>
  

  
  
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Rollout&amp;url=https%3a%2f%2fjayanthrr.github.io%2fpost%2frollout%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fjayanthrr.github.io%2fpost%2frollout%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fjayanthrr.github.io%2fpost%2frollout%2f&amp;title=Rollout"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fjayanthrr.github.io%2fpost%2frollout%2f&amp;title=Rollout"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Rollout&amp;body=https%3a%2f%2fjayanthrr.github.io%2fpost%2frollout%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      

<p><em>Life can only be understood going backwards, but it must be lived going forwards - Kierkegaard</em>.</p>

<p>Dynamic Programming is a mathematical technique that is used in several fields of research including economics, finance, engineering. It deals with making decisions over different stages of the problem in order to minimize (or maximize) a corresponding cost function (or reward). The outcome of a decision at a given stage can be fully predicted (deterministic) or can only be partially predicted (with randomness involved). One key aspect of such problems is the trade off in optimizing the cost incurred at the current stage and the cost to be incurred at a future stage.</p>

<p>Dynamic Programming is very helpful in many contexts by providing an exact solution, however, when the problem size increases, it requires enormous amount of storage and computational time (often referred to as the <em>curse of dimensionality</em>) which makes it infeasible to apply to practical situations. Often in such situations, one may not desire an exact solution, but an approximately optimal (or suboptimal) solution. Then there must be a better class of techniques that can capture this trade off between feasibility and sub optimality. These techniques are collectively referred to as <em>Approximate Dynamic Programming</em> or <em>Reinforcement Learning</em> (in the field of AI) or <em>Neuro Dynamic Programming</em> (in the field of automatic control), all of which essentially mean the same.</p>

<p>In this blog post, we shall look at a specific technique called <em>Rollout Algorithm</em> that is quite extensively used (with surprisingly good results). In fact, <a href="https://www.nature.com/articles/nature16961" target="_blank">Mastering the game of Go, DeepMind</a> uses a variant of <em>Rollout</em> called <em>Monte Carlo Tree Search</em>. We shall first formulate a DP problem, state the DP algorithm and illustrate with an example the infeasibility of DP. Using the same example, we shall study how <em>Rollout</em> offers an effective solution that optimizes the trade-off between accuracy and computation. This post is entirely based on my reading of the book <a href="http://web.mit.edu/dimitrib/www/dpchapter.html" target="_blank">Approximate Dynamic Programming</a>.</p>

<p><img src="/img/DP1.png" alt="DP" /></p>

<h1 id="dp-formulation">DP formulation</h1>

<p>In this post, we shall focus only on finite horizon problems (problems involving a finite number of stages or time steps at which a decision is taken). We denote the state of the system at time $k$ as $x<em>{k}$ (belongs to a space $S</em>{k}$), and the decision (or control) taken as $u<em>{k}$ (belongs to a space $U</em>{k}(x<em>{k})$), and a random variable $w</em>{k}$ (which is independent of other $w_{i}$) that affects the system. The system has the form</p>

<p>$$x<em>{k+1} = f</em>{k}(x<em>{k}, u</em>{k}, w_{k}) $$</p>

<p>where $k$ takes a value between $0$ and $N$ (finite horizon). At each stage, there is a cost incurred $g<em>{k}(x</em>{k}, u<em>{k}, w</em>{k})$ which accumulates over time. The total cost incurred is then</p>

<p>$$ g<em>{N}(x</em>{N}) + \sum<em>{k=0}^{N-1}g</em>{k}(x<em>{k}, u</em>{k}, w_{k})$$</p>

<p>where $g<em>{N}(x</em>{N})$ is a terminal cost incurred at the final stage (it only depends on the state, and no action is to be taken). The objective of the problem is to find an optimal policy</p>

<p>$$\pi:= {\mu<em>{0},..,\mu</em>{k},.. \mu_{N-1}}$$</p>

<p>(where $\mu<em>{k} = u</em>{k}(x<em>{k})$) that minimizes the expected cost (we take an expectation due to the random variable $w</em>{k}$). Given an initial state $x<em>{0}$, the expected cost of following a policy $\pi$ starting from $x</em>{0}$ is denoted as</p>

<p>$$ J<em>{\pi}(x</em>{0}) = \mathbb{E}\big[g<em>{N}(x</em>{N}) + \sum<em>{k=0}^{N-1}g</em>{k}(x<em>{k}, u</em>{k}, w_{k})]$$</p>

<p>An optimal policy $\pi^{*}$ is the one that minimizes this expected cost; i.e,</p>

<p>$$ J<em>{\pi^{*}}(x</em>{0}) = \min<em>{\pi \in \Pi} J</em>{\pi}(x_{0})$$</p>

<p>where $\Pi$ is the space of admissible policies.</p>

<h1 id="bellman-s-principle-of-optimality-and-the-dp-algorithm">Bellman&rsquo;s principle of optimality and the DP algorithm</h1>

<p>Let $\pi^{*}={\mu<em>{0}^{*},..,\mu</em>{k}^{*},.. \mu<em>{N-1}^{*}}$ be an optimal policy of the problem stated above, and assume that when using $\pi^{*}$, a given state $x</em>{i}$ occurs at time $i$ with positive probability. Consider the subproblem, whereby we are at $x_{i}$ at time $i$ and wish to minimze the &ldquo;cost-to-go&rdquo; from time $i$ to time $N$</p>

<p>$$ \mathbb{E}\bigg[g<em>{N}(x</em>{N}) + \sum<em>{k=i}^{N-1}g</em>{k}(x<em>{k}, u</em>{k}, w_{k})\bigg]$$</p>

<p>Then the truncated policy ${\mu<em>{i}^{*},\mu</em>{i+1}^{*},.. \mu_{N-1}^{*}}$ is optimal for this subproblem.</p>

<p>Intuitively, let us look at the following problem where we start from A and we need to reach the destination E, and the edge weights are the costs incurred for traversing that edge. The path that minimizes the cost is A-B-D-E. Equivalently, the decision (corresponds to choosing the next node) taken at each time step are B at k=0, D at k=1 and E at k=2. If the policy determined by the path A-B-D-E is optimal, then the truncated path B-D-E is also optimal. If it were not, then we can further reduce the cost by choosing the optimal path which contradicts the fact that A-B-D-E is the path with the minimum cost.</p>

<p><img src="../images/DP1.png" alt="" /></p>

<h2 id="dp-algorithm">DP Algorithm</h2>

<p>The DP algorithm proceeds as follows. We start from the last step of decision making ($N-1$) and proceed backwards performing the minimization</p>

<p>$$ J<em>{N}(x</em>{N}) = g<em>{N}(x</em>{N}) $$</p>

<p>$$ J<em>{k}(x</em>{k}) = \min<em>{u</em>{k}\in U<em>{k}(x</em>{k})} \mathbb{E}<em>{w</em>{k}}\bigg[g<em>{N}(x</em>{N}) + \sum<em>{k=0}^{N-1}g</em>{k}(x<em>{k}, u</em>{k}, w_{k})\bigg], k = 0,1,..,N-1$$</p>

<p>where the expectation is taken with respect to the probability distribution of $w<em>{k}$ which is assumed to depend on $x</em>{k}, u<em>{k}$. Furthermore, if
$\mu^{*}</em>{k}=u<em>{k}^{*}(x</em>{k})$ minimizes the above equation, then the policy $\pi^{*}={\mu<em>{0}{*},&hellip;,\mu</em>{k}{*},&hellip;,\mu_{N-1}{*}}$ is optimal.</p>

<h1 id="example">Example</h1>

<h1 id="one-step-lookahead-multi-step-lookahead">One-step lookahead, multi-step lookahead</h1>

<h1 id="rollout">Rollout</h1>

<h1 id="conclusion">Conclusion</h1>

<h2 id="references">References</h2>

    </div>

    





    
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "@jayanthreddyregatti" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//@jayanthreddyregatti.disqus.com/count.js" async></script>
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

